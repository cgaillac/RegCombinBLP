% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/emd_1d_sorted.R
\name{emd_1d_sorted}
\alias{emd_1d_sorted}
\title{Compute 1D Earth Mover's Distance (EMD) for Sorted Distributions}
\usage{
emd_1d_sorted(u_weights, v_weights, u, v, metric = "sqeuclidean", p = 2)
}
\arguments{
\item{u_weights}{Numeric vector of weights for the `u` distribution. Must be same length as `u`.}

\item{v_weights}{Numeric vector of weights for the `v` distribution. Must be same length as `v`.}

\item{u}{Numeric vector of sorted points for the first distribution.}

\item{v}{Numeric vector of sorted points for the second distribution.}

\item{metric}{Character. Distance metric to use. Options:
1. `'sqeuclidean'` (default): squared Euclidean distance.
2. `'euclidean'` or `'cityblock'`: absolute distance.
3. `'minkowski'`: Minkowski distance with order `p`.}

\item{p}{Numeric. Power parameter for the Minkowski metric (default is 2.0).}
}
\value{
A list with components:
\describe{
  \item{G}{Numeric vector of transported weights along the optimal flow.}
  \item{indices}{Matrix of indices indicating source (`u`) and target (`v`) positions for each transported weight.}
  \item{cost}{Numeric scalar. The total transportation cost (EMD) between `u` and `v`.}
}
}
\description{
This function computes the 1-dimensional Earth Mover's Distance (EMD) between two
sorted distributions with associated weights. The distributions `u` and `v`
must be sorted in ascending order. It supports different distance metrics.
}
\details{
This function assumes that `u` and `v` are sorted in ascending order. The algorithm
implements a simple greedy approach for 1D distributions:
it iteratively moves weight from the current source to the current target until
all mass is transported. Different distance metrics can be specified to compute
the cost, including squared Euclidean, Manhattan, and Minkowski distances.
}
\note{
Adapted from the Python Optimal Transport (POT) library:
Flamary R., Vincent-Cuaz C., Courty N., Gramfort A., et al. POT Python Optimal Transport (version 0.9.5).
URL: https://github.com/PythonOT/POT
}
\examples{
\dontrun{
# Simple example with uniform weights
u <- c(1, 2, 3)
v <- c(2, 3, 4)
u_weights <- c(0.3, 0.4, 0.3)
v_weights <- c(0.5, 0.2, 0.3)
emd_1d_sorted(u_weights, v_weights, u, v)

# Using the Minkowski distance
emd_1d_sorted(u_weights, v_weights, u, v, metric = 'minkowski', p = 3)
}
}
